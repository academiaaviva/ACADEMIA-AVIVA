<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tablero de Administración - AVIVA</title>
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

    <header>
        <div class="header-contenido">
            <img src="https://i.ibb.co/Qv2NxLbN/fbbf9ca0-b866-4ce4-a827-443177c32603-removebg-preview.png" alt="Logo AVIVA" class="logo-header">
            <h1>Tablero de Administración</h1>
            <a href="maestros.html" style="margin-left: auto; color: #DAA520; font-size: 1.1em;">
                 <i class="fas fa-power-off"></i> Cerrar Sesión
            </a>
        </div>
    </header>

    <main class="contenido-admin">
        
        <h2>Menú Principal</h2>
        
        <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 20px;">
            <a href="admonestudiantes.html" class="boton-rol" style="width: calc(50% - 10px); background-color: #082348;">
                <i class="fas fa-user-graduate"></i> Gestión de Estudiantes
            </a>
            <a href="admonclases.html" class="boton-rol" style="width: calc(50% - 10px); background-color: #082348;">
                <i class="fas fa-book"></i> Gestión de Clases
            </a>
            <a href="pagos.html" class="boton-rol" style="width: calc(50% - 10px); background-color: #082348;">
                <i class="fas fa-dollar-sign"></i> Gestión de Pagos
            </a>
            <a href="admonconfi.html" class="boton-rol" style="width: calc(50% - 10px); background-color: #082348;">
                <i class="fas fa-cog"></i> Configuración
            </a>
        </div>
        
        <div class="tarjeta-gestion" style="margin-top: 30px;">
            <h4>Resumen Rápido (Datos Dinámicos)</h4>
            <p><strong>Estudiantes Activos:</strong> <span id="estudiantes-activos">Cargando...</span></p> 
            
            <p><strong>Ingresos del Mes:</strong> $5,450</p>
            <p><strong>Tareas Pendientes:</strong> 3</p>
        </div>

    </main>
    
    <footer>
        <p><a href="#" class="enlace-footer">Acerca de</a> | &copy; 2025 Academia AVIVA.</p>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script>
        // *** 1. TUS CLAVES DE CONFIGURACIÓN DE FIREBASE ***
        const firebaseConfig = {
          apiKey: "AIzaSyC1siR7mrHnOTXozBk6lZ22ZxU352ve4lI",
          authDomain: "academia-aviva.firebaseapp.com",
          projectId: "academia-aviva",
          storageBucket: "academia-aviva.firebasestorage.app",
          messagingSenderId: "1083662705160",
          appId: "1:1083662705160:web:31252ae5d15e994823a7bd",
          measurementId: "G-GNBRN8CF2T"
        };
        
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        
        // Referencia a Firestore
        const db = firebase.firestore();

        // Referencia a la colección 'estudiantes'
        const estudiantesCollection = db.collection('estudiantes');

        // Referencia al elemento HTML
        const estudiantesActivosSpan = document.getElementById('estudiantes-activos');

        // ==================================================
        // 2. FUNCIÓN PARA CARGAR Y MOSTRAR EL CONTEO
        // ==================================================
        function actualizarConteo(snapshot) {
            // El snapshot.size da el número total de documentos en la colección
            const totalEstudiantes = snapshot.size;
            
            estudiantesActivosSpan.textContent = totalEstudiantes;
            
            // Opcional: Si quieres contar solo los "Activos"
            // let activos = 0;
            // snapshot.forEach(doc => {
            //     if (String(doc.data().estado).toLowerCase() === 'activo') {
            //         activos++;
            //     }
            // });
            // estudiantesActivosSpan.textContent = activos; 
        }

        // ==================================================
        // 3. CARGA INICIAL Y ESCUCHA EN TIEMPO REAL
        // ==================================================
        // onSnapshot escucha los cambios en tiempo real y llama a actualizarConteo
        estudiantesCollection.onSnapshot(actualizarConteo, error => {
            console.error("Error al obtener el conteo de estudiantes:", error);
            estudiantesActivosSpan.textContent = "Error de conexión.";
        });

    </script>

</body>
</html>
